
THREE.EffectComposer=function(e,d){this.renderer=e;if(d===undefined){var b=window.innerWidth||1;var a=window.innerHeight||1;var c={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:false};d=new THREE.WebGLRenderTarget(b,a,c)}this.renderTarget1=d;this.renderTarget2=d.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;this.passes=[];if(THREE.CopyShader===undefined){console.error("THREE.EffectComposer relies on THREE.CopyShader")}this.copyPass=new THREE.ShaderPass(THREE.CopyShader)};THREE.EffectComposer.prototype={swapBuffers:function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer;this.writeBuffer=a},addPass:function(a){this.passes.push(a)},insertPass:function(b,a){this.passes.splice(a,0,b)},render:function(f){this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2;var a=false;var e,d,b=this.passes.length;for(d=0;d<b;d++){e=this.passes[d];if(!e.enabled){continue}e.render(this.renderer,this.writeBuffer,this.readBuffer,f,a);if(e.needsSwap){if(a){var c=this.renderer.context;c.stencilFunc(c.NOTEQUAL,1,4294967295);this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,f);c.stencilFunc(c.EQUAL,1,4294967295)}this.swapBuffers()}if(e instanceof THREE.MaskPass){a=true}else{if(e instanceof THREE.ClearMaskPass){a=false}}}},reset:function(a){if(a===undefined){a=this.renderTarget1.clone();a.width=window.innerWidth;a.height=window.innerHeight}this.renderTarget1=a;this.renderTarget2=a.clone();this.writeBuffer=this.renderTarget1;this.readBuffer=this.renderTarget2},setSize:function(b,a){var c=this.renderTarget1.clone();c.width=b;c.height=a;this.reset(c)}};THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null);THREE.EffectComposer.scene=new THREE.Scene();THREE.EffectComposer.scene.add(THREE.EffectComposer.quad);