
THREE.OrbitControls=function(D,C){this.object=D;this.domElement=(C!==undefined)?C:document;this.enabled=true;this.target=new THREE.Vector3();this.center=this.target;this.noZoom=false;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=false;this.rotateSpeed=1;this.noPan=false;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.noKeys=false;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var a=this;var r=0.000001;var y=new THREE.Vector2();var f=new THREE.Vector2();var n=new THREE.Vector2();var c=new THREE.Vector2();var k=new THREE.Vector2();var x=new THREE.Vector2();var b=new THREE.Vector2();var s=new THREE.Vector2();var v=new THREE.Vector2();var h=0;var B=0;var E=1;var q=new THREE.Vector3();var p=new THREE.Vector3();var u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var g=u.NONE;var A={type:"change"};this.rotateLeft=function(F){if(F===undefined){F=i()}B-=F};this.rotateUp=function(F){if(F===undefined){F=i()}h-=F};this.panLeft=function(H){var F=new THREE.Vector3();var G=this.object.matrix.elements;F.set(G[0],G[1],G[2]);F.multiplyScalar(-H);q.add(F)};this.panUp=function(H){var F=new THREE.Vector3();var G=this.object.matrix.elements;F.set(G[4],G[5],G[6]);F.multiplyScalar(H);q.add(F)};this.pan=function(J){var G=a.domElement===document?a.domElement.body:a.domElement;if(a.object.fov!==undefined){var F=a.object.position;var I=F.clone().sub(a.target);var H=I.length();H*=Math.tan((a.object.fov/2)*Math.PI/180);a.panLeft(2*J.x*H/G.clientHeight);a.panUp(2*J.y*H/G.clientHeight)}else{if(a.object.top!==undefined){a.panLeft(J.x*(a.object.right-a.object.left)/G.clientWidth);a.panUp(J.y*(a.object.top-a.object.bottom)/G.clientHeight)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")}}};this.dollyIn=function(F){if(F===undefined){F=t()}E/=F};this.dollyOut=function(F){if(F===undefined){F=t()}E*=F};this.update=function(){var G=this.object.position;var J=G.clone().sub(this.target);var H=Math.atan2(J.x,J.z);var I=Math.atan2(Math.sqrt(J.x*J.x+J.z*J.z),J.y);if(this.autoRotate){this.rotateLeft(i())}H+=B;I+=h;I=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,I));I=Math.max(r,Math.min(Math.PI-r,I));var F=J.length()*E;F=Math.max(this.minDistance,Math.min(this.maxDistance,F));this.target.add(q);J.x=F*Math.sin(I)*Math.sin(H);J.y=F*Math.cos(I);J.z=F*Math.sin(I)*Math.cos(H);G.copy(this.target).add(J);this.object.lookAt(this.target);B=0;h=0;E=1;q.set(0,0,0);if(p.distanceTo(this.object.position)>0){this.dispatchEvent(A);p.copy(this.object.position)}};function i(){return 2*Math.PI/60/60*a.autoRotateSpeed}function t(){return Math.pow(0.95,a.zoomSpeed)}function j(F){if(a.enabled===false){return}F.preventDefault();if(F.button===0){if(a.noRotate===true){return}g=u.ROTATE;y.set(F.clientX,F.clientY)}else{if(F.button===1){if(a.noZoom===true){return}g=u.DOLLY;b.set(F.clientX,F.clientY)}else{if(F.button===2){if(a.noPan===true){return}g=u.PAN;c.set(F.clientX,F.clientY)}}}a.domElement.addEventListener("mousemove",m,false);a.domElement.addEventListener("mouseup",e,false)}function m(G){if(a.enabled===false){return}G.preventDefault();var F=a.domElement===document?a.domElement.body:a.domElement;if(g===u.ROTATE){if(a.noRotate===true){return}f.set(G.clientX,G.clientY);n.subVectors(f,y);a.rotateLeft(2*Math.PI*n.x/F.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*n.y/F.clientHeight*a.rotateSpeed);y.copy(f)}else{if(g===u.DOLLY){if(a.noZoom===true){return}s.set(G.clientX,G.clientY);v.subVectors(s,b);if(v.y>0){a.dollyIn()}else{a.dollyOut()}b.copy(s)}else{if(g===u.PAN){if(a.noPan===true){return}k.set(G.clientX,G.clientY);x.subVectors(k,c);a.pan(x);c.copy(k)}}}a.update()}function e(){if(a.enabled===false){return}a.domElement.removeEventListener("mousemove",m,false);a.domElement.removeEventListener("mouseup",e,false);g=u.NONE}function l(F){if(a.enabled===false||a.noZoom===true){return}var G=0;if(F.wheelDelta){G=F.wheelDelta}else{if(F.detail){G=-F.detail}}if(G>0){a.dollyOut()}else{a.dollyIn()}}function d(F){if(a.enabled===false){return}if(a.noKeys===true){return}if(a.noPan===true){return}var G=false;switch(F.keyCode){case a.keys.UP:a.pan(new THREE.Vector2(0,a.keyPanSpeed));G=true;break;case a.keys.BOTTOM:a.pan(new THREE.Vector2(0,-a.keyPanSpeed));G=true;break;case a.keys.LEFT:a.pan(new THREE.Vector2(a.keyPanSpeed,0));G=true;break;case a.keys.RIGHT:a.pan(new THREE.Vector2(-a.keyPanSpeed,0));G=true;break}if(G){a.update()}}function w(H){if(a.enabled===false){return}switch(H.touches.length){case 1:if(a.noRotate===true){return}g=u.TOUCH_ROTATE;y.set(H.touches[0].pageX,H.touches[0].pageY);break;case 2:if(a.noZoom===true){return}g=u.TOUCH_DOLLY;var G=H.touches[0].pageX-H.touches[1].pageX;var F=H.touches[0].pageY-H.touches[1].pageY;var I=Math.sqrt(G*G+F*F);b.set(0,I);break;case 3:if(a.noPan===true){return}g=u.TOUCH_PAN;c.set(H.touches[0].pageX,H.touches[0].pageY);break;default:g=u.NONE}}function o(I){if(a.enabled===false){return}I.preventDefault();I.stopPropagation();var H=a.domElement===document?a.domElement.body:a.domElement;switch(I.touches.length){case 1:if(a.noRotate===true){return}if(g!==u.TOUCH_ROTATE){return}f.set(I.touches[0].pageX,I.touches[0].pageY);n.subVectors(f,y);a.rotateLeft(2*Math.PI*n.x/H.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*n.y/H.clientHeight*a.rotateSpeed);y.copy(f);break;case 2:if(a.noZoom===true){return}if(g!==u.TOUCH_DOLLY){return}var G=I.touches[0].pageX-I.touches[1].pageX;var F=I.touches[0].pageY-I.touches[1].pageY;var J=Math.sqrt(G*G+F*F);s.set(0,J);v.subVectors(s,b);if(v.y>0){a.dollyOut()}else{a.dollyIn()}b.copy(s);break;case 3:if(a.noPan===true){return}if(g!==u.TOUCH_PAN){return}k.set(I.touches[0].pageX,I.touches[0].pageY);x.subVectors(k,c);a.pan(x);c.copy(k);break;default:g=u.NONE}}function z(){if(a.enabled===false){return}g=u.NONE}this.domElement.addEventListener("contextmenu",function(F){F.preventDefault()},false);this.domElement.addEventListener("mousedown",j,false);this.domElement.addEventListener("mousewheel",l,false);this.domElement.addEventListener("DOMMouseScroll",l,false);this.domElement.addEventListener("keydown",d,false);this.domElement.addEventListener("touchstart",w,false);this.domElement.addEventListener("touchend",z,false);this.domElement.addEventListener("touchmove",o,false)};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);